```{r}
# db connection
source("~/Desktop/Documents/GitHub/bias assessment/connect_db.R")

# bias function
source("~/Desktop/Documents/GitHub/bias assessment/occAssess_bias_function.R")
```


```{r}
# Tables to analyse
tables = dbListTables(conn = aws_con)
tables = tables[-grep("lag", tables)][-grep("backbone", tables)] |> sort()
```


```{r}
# generate bias output files
for (db_table in tables) {
  Bias_assessment_function(db_table = db_table, con = aws_con, periods_length = 10)
}
```